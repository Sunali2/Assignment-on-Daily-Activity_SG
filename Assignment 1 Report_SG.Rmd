---
title: "Course Project1_ SG"
author: "Sunali Goonesekera"
date: "2026-02-21"
output: html_document
---
Code used to load the data:
```{r}
library(dplyr)
library(lubridate)
activity <- read.csv("C:/Users/sunal/OneDrive/Documents/datasciencecoursera/NewSG/rep_data_activity/activity.csv", stringsAsFactors=FALSE) 
echo=TRUE
```
#Question 1: 
Calculating the total number of steps taken per day and plotting a histogram:
```{r}
Steps_by_date <- activity %>%
  group_by(date) %>%
  summarise(total_steps_day = sum(steps, na.rm = TRUE))
hist(Steps_by_date$total_steps_day, main = "Total Steps per Day", xlab = "Total Steps", ylab = "Frequency", col = "red")
echo=TRUE
```
Mean and median total steps per day:
```{r}
names(Steps_by_date)
mean_steps <- mean(Steps_by_date$total_steps_day, na.rm = TRUE)
median_steps <- median(Steps_by_date$total_steps_day, na.rm = TRUE)
print(mean_steps)
print(median_steps)
echo=TRUE
```
#Question 2:Daily average activity pattern and five minute interval with maximum steps:
```{r}
Mean_steps_by_interval <- activity %>%
  group_by(interval) %>%
  summarise(mean_steps = mean(steps, na.rm = TRUE))
plot(x=Mean_steps_by_interval$interval, y=Mean_steps_by_interval$mean_steps, type = "l", main = "Average Daily Activity Pattern", xlab = "Time in minutes",
     ylab = "Average Steps per 5 minute interval")


max_interval <- Mean_steps_by_interval$interval[which.max(Mean_steps_by_interval$mean_steps)] 
print(max_interval)
echo=TRUE
```

#Question 3: Imputing missing values
```{r}
activity_imputed <- activity %>%
  group_by(interval) %>%
  mutate(steps = ifelse(is.na(steps), mean(steps, na.rm = TRUE), steps))
Total_steps_by_date_imputed <- activity_imputed %>%
  group_by(date) %>%
  summarise(total_steps = sum(steps))

hist(Total_steps_by_date_imputed$total_steps, main = "Total Steps per Day (Imputed)", xlab = "Total Steps", ylab = "Frequency", col = "blue") 
mean_steps_imputed <- mean(Total_steps_by_date_imputed$total_steps, na.rm = TRUE)
median_steps_imputed <- median(Total_steps_by_date_imputed$total_steps, na.rm = TRUE)
print(mean_steps_imputed)
print(median_steps_imputed)
echo=TRUE
```
#Question 4: Are there differences in activity patterns between weekdays and weekends?
```{r}
activity_imputed$weekday <- weekdays(as.Date(activity_imputed$date))
Weekday <- subset(activity_imputed, weekday %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday"))
Weekend <- subset(activity_imputed, weekday %in% c("Saturday", "Sunday"))
Mean_steps_by_interval_weekday <- Weekday %>%
  group_by(interval) %>%
  summarise(mean_steps = mean(steps, na.rm = TRUE))
Mean_steps_by_interval_weekend <- Weekend %>%
  group_by(interval) %>%
  summarise(mean_steps = mean(steps, na.rm = TRUE))
par(mfrow=c(2,1))
plot(x=Mean_steps_by_interval_weekday$interval, y=Mean_steps_by_interval_weekday$mean_steps, type = "l", main = "Average Daily Activity Pattern (Weekdays)", xlab = "Time in minutes", ylab = "Average Steps per 5 minute interval")
plot(x=Mean_steps_by_interval_weekend$interval, y=Mean_steps_by_interval_weekend$mean_steps, type = "l", main = "Average Daily Activity Pattern (Weekends)", xlab = "Time in minutes", ylab = "Average Steps per 5 minute interval")
echo=TRUE
```